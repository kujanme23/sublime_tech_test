name: "Inbound OCR password expired lure (attachment)"
description: "Inbound email has an image attachment whose extracted text suggests a password expiration/reset lure."
type: rule
severity: medium

source: |
  type.inbound
  and any(attachments,
    .file_extension in~ ("png", "jpg", "jpeg")
    and any(file.explode(.),
      any(.scan.strings.strings, strings.ilike(., "*password*"))
      and (
        any(.scan.strings.strings, strings.ilike(., "*expire*"))
        or any(.scan.strings.strings, strings.ilike(., "*reset*"))
        or any(.scan.strings.strings, strings.ilike(., "*update*"))
      )
    )
  )
